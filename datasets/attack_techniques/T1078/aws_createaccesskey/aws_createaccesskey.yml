author: Bhavin Patel
id: cc9b263b-efc9-11eb-926b-550bf0943fbb
date: '2021-02-22'
description: CloudTrail events where a user A who has already permission to create
  access keys, makes an API call to create access keys for another user B. Attackers
  have been know to use this technique for Privilege Escalation in case new victim(user
  B) has more permissions than old victim(user B)
environment: Cloud Attack Range
dataset:
- https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078/aws_createaccesskey/aws_cloudtrail_events.json
- https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078/amazon_security_lake.json
sourcetypes:
- aws:cloudtrail
- aws:asl
references:
- https://labs.bishopfox.com/tech-blog/privilege-escalation-in-aws
- https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation-part-2/
