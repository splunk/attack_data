author: Mauricio Velazco
id: 5edadd1e-f507-4924-8622-6c85eeea3990
date: '2022-09-02'
description: 'Manually updated the ImmutableId atribute using the Set-MsolUser PowerShell commandlet.
  Tenant specific details have been replaced in the dataset including tenant id, user names, ips, etc.'
environment: Azure AD tenant
dataset:
- https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1098/azure_ad_set_immutableid/azure-audit.log
sourcetypes:
- mscs:azure:eventhub
references:
- https://www.mandiant.com/resources/blog/remediation-and-hardening-strategies-for-microsoft-365-to-defend-against-unc2452
- https://o365blog.com/post/federation-vulnerability/
- https://www.inversecos.com/2021/11/how-to-detect-azure-active-directory.html
- https://www.mandiant.com/resources/blog/detecting-microsoft-365-azure-active-directory-backdoors
- https://github.com/Gerenios/AADInternals
- https://attack.mitre.org/techniques/T1098/
